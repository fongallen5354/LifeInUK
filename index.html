<!DOCTYPE html>
<html>
<head>
  <title>Revision Quiz</title>
  <style>
    body {
      font-family: sans-serif;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .question-container {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 5px;
    }
    .options label {
      display: block;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    #results {
      margin-top: 20px;
      font-weight: bold;
    }
    .correct {
      color: green;
    }
    .incorrect {
      color: red;
    }
  </style>
</head>
<body>

  <h1>Revision Quiz</h1>

  <div id="quiz-container"></div>

  <button id="submit-button">Submit Answers</button>

  <div id="results"></div>

  <script>
    const quizContainer = document.getElementById('quiz-container');
    const submitButton = document.getElementById('submit-button');
    const resultsContainer = document.getElementById('results');

    async function loadQuiz() {
      try {
        const response = await fetch('questions.csv');
        const text = await response.text();
        const lines = text.split('\n').filter(line => line.trim() !== '');
        const questions = lines.slice(1).map(line => {
          const [question, optionA, optionB, optionC, optionD, correctAnswer] = line.split(',');
          return {
            question: question.replace(/"/g, ''),
            options: [optionA.replace(/"/g, ''), optionB.replace(/"/g, ''), optionC.replace(/"/g, ''), optionD.replace(/"/g, '')],
            correctAnswer: correctAnswer.replace(/"/g, '')
          };
        });

        displayQuestions(questions);
        submitButton.addEventListener('click', () => showResults(questions));

      } catch (error) {
        resultsContainer.innerHTML = 'Error loading the quiz: ' + error;
      }
    }

    function displayQuestions(questions) {
      questions.forEach((q, index) => {
        const questionElement = document.createElement('div');
        questionElement.classList.add('question-container');
        questionElement.innerHTML = `
          <p><b>${q.question}</b></p>
          <div class="options">
            ${q.options.map((option, i) => `
              <label>
                <input type="radio" name="question${index}" value="${option}">
                ${option}
              </label>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionElement);
      });
    }

    function showResults(questions) {
      let score = 0;
      let incorrectAnswers = [];

      questions.forEach((q, index) => {
        const selectedOption = document.querySelector(`input[name="question${index}"]:checked`);
        const questionContainer = document.querySelector(`.question-container:nth-of-type(${index + 1})`);
        
        if (selectedOption) {
          if (selectedOption.value.trim() === q.correctAnswer.trim()) {
            score++;
            questionContainer.style.backgroundColor = '#d4edda'; // Light green for correct
          } else {
            incorrectAnswers.push({
              question: q.question,
              yourAnswer: selectedOption.value,
              correctAnswer: q.correctAnswer
            });
            questionContainer.style.backgroundColor = '#f8d7da'; // Light red for incorrect
          }
        } else {
          // If no option is selected, treat it as incorrect
          incorrectAnswers.push({
            question: q.question,
            yourAnswer: 'Not answered',
            correctAnswer: q.correctAnswer
          });
          questionContainer.style.backgroundColor = '#f8d7da'; // Light red for not answered
        }
      });

      let resultsHTML = `<h2>Your Score: ${score} out of ${questions.length}</h2>`;
      if (incorrectAnswers.length > 0) {
        resultsHTML += '<h3>Incorrect Answers:</h3><ul>';
        incorrectAnswers.forEach(item => {
          resultsHTML += `<li><b>${item.question}</b><br>Your Answer: <span class="incorrect">${item.yourAnswer}</span><br>Correct Answer: <span class="correct">${item.correctAnswer}</span></li>`;
        });
        resultsHTML += '</ul>';
      }
      resultsContainer.innerHTML = resultsHTML;
    }

    loadQuiz();
  </script>

</body>
</html>
